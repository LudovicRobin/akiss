symbols open/2, commit/2, check/2, sign/2, pk/1, unblind/2, blind/2,
pair/2, fst/1, snd/1, yes/0, no/0, A/0, B/0;

private rAyes, bAyes, kA, rBno, bBno;

var x, y, z, xAyes, xBno;

rewrite open(commit(x, y), y) -> x;
rewrite check(sign(x, y), pk(y)) -> x;
rewrite check(unblind(sign(blind(x, y), z), y), pk(z)) -> x;
rewrite fst(pair(x, y)) -> x;
rewrite snd(pair(x, y)) -> y;

To1 = out(pk(kB)).out(sign(blind(commit(no, rBno), bBno),
kB)).in(xBno).out(unblind(xBno, bBno)).out(rBno).0;

Rest = out(rAyes).0;

kb To1;
