\documentclass{article}
\usepackage{amssymb} \usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{msc5}
\usepackage{multirow}

\newcommand{\N}{\mathcal{N}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}
\newcommand{\W}{\mathcal{W}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\T}{\mathcal{T}}
\newcommand{\Ch}{\mathcal{C}h}

\newcommand{\R}{\mathcal{R}}
\newcommand{\nf}{\ensuremath{{\downarrow}}}
\newcommand{\rewrite}[1]{\ensuremath{\rightarrow_{#1}^*}}

\newcommand{\mgu}{\operatorname{mgu}}
\newcommand{\csu}{\operatorname{csu}}
\newcommand{\variants}{\operatorname{variants}}
\newcommand{\vars}{\operatorname{vars}}
\newcommand{\dom}{\operatorname{dom}}
\newcommand{\im}{\operatorname{Im}}

\newcommand{\E}{\mathsf{E}}
\newcommand{\pub}{\mathsf{pub}}
\newcommand{\prv}{\mathsf{prv}}
\newcommand{\guess}{\mathsf{guess}}
\newcommand{\proj}{\mathsf{proj}}
\newcommand{\hash}{\mathsf{hash}}
\newcommand{\shash}{\mathsf{sh}}
\newcommand{\bruteforce}{\mathsf{bf}}
\newcommand{\ffun}{\mathsf{f}}
\newcommand{\gfun}{\mathsf{g}}
\newcommand{\w}{\mathsf{w}} % est ce qu'on le garde ? 

\renewcommand{\test}{\ensuremath{\textbf{test}}}

\newcommand{\testpo}{\ensuremath{\textbf{test}}^=}
\newcommand{\testne}{\ensuremath{\textbf{test}}^{\neq}}

\newcommand{\nill}{\textbf{0}}
\newcommand{\Out}{\ensuremath{\textbf{out}}}
\newcommand{\In}{\ensuremath{\textbf{in}}}
\newcommand{\testeq}{=} % S.D.: j'ai enleve le
\newcommand{\difftesteq}{\neq} % S.D.: j'ai enleve le

\newcommand{\Guess}{\ensuremath{\textbf{guess}}}
\newcommand{\p}{\mathcal{P}}
\newcommand{\q}{\mathcal{Q}}

\newcommand{\eqconseq}{{\cal H}_{\sf e}}

\newcommand{\horn}{\ensuremath{\Leftarrow}}
\newcommand{\init}{\mathsf{init}}
\newcommand{\myvec}[1]{\overrightarrow{#1}}
\newcommand{\reach}{\ensuremath{\mathsf{r}}}
\newcommand{\knows}{\ensuremath{\mathsf{\mathrel k}}}
\newcommand{\identical}{\ensuremath{\mathsf{i}}}
\newcommand{\testp}{\ensuremath{\mathsf{ri}}}
\newcommand{\seed}[1] {\ensuremath{\mathsf{seed}(#1)}}
\newcommand{\act}{\mathsf{a}}
\newcommand{\simconseq}{{\cal H}}

\newcommand{\solved}[1]{#1_{\textsolved}}
\newcommand{\textsolved}{{\sf solved}}
\newcommand{\sat}{{\sf sat}}
\newcommand{\update}{\Cup}

\newcommand{\cf}{\ensuremath{\mathord{\Downarrow}}}
\newcommand{\conseq}{\ensuremath{\mathbf{conseq}}}
\newcommand{\vguess}{\Vdash}
%\def\vguess{\begin{tikzpicture} \draw (-0.05,-0.2) -- (-0.05,0.05); \node[scale=0.77] (g1) at (0.055,-0.1) {$\sim$ };\end{tikzpicture}}


\newcommand{\akiss}{{\sf AKISS}\xspace}


\newcommand{\strong}{\mathsf{strong}}
\newcommand{\weak}{\mathsf{weak}}
%\newcommand{\info}{\mathit{info}}
\newcommand{\infoA}{\mathit{info_A}}
\newcommand{\infoI}{\mathit{info_I}}
\newcommand{\ack}{\mathit{ack}}

\newcommand{\Tpo}{T^=}
\newcommand{\Tne}{T^{\neq}}

\newtheorem{example}{Example}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{claim}{Claim}
\newtheorem{corollary}{Corollary}
\newtheorem{theorem}{Theorem}
\newenvironment{proof}{\emph{Proof.}}

\newcommand{\qed}{\hfill$\Box$}



\begin{document}
    
\begin{figure}
%\resizebox{0.55\textwidth}{!}
{
  \setmsckeyword{} \drawframe{no}
  \begin{msc}{}
       \setlength{\instwidth}{0\mscunit}
       \setlength{\instdist}{1.85cm} 
      \declinst{A}{Device A}

      \dummyinst{d1} 

      \declinst{H}{Human user}

      \dummyinst{d2} 

      \declinst{B}{Device B}

   \nextlevel[-1]
      \mess{data $d_A$}{d1}{A}
      \mess{data $d_B$}{d2}{B}
      \nextlevel[0,5]
      \action*{
        \begin{tabular}{l}
          new $r$\\
        \end{tabular}
      }{A}
      \nextlevel[2]
      \action*{
        \begin{tabular}{l}
          new $k$\\
        \end{tabular}
      }{A}
      \nextlevel[1,5]
      \nextlevel[1,5]
      \mess{$m_0 = \hash(d_A,k,r)$}{A}{B}
      \nextlevel[1,4]
      \mess{ready}{A}{H}
      \mess{ready}{B}{H}
      \nextlevel[1,4]
      \mess{start}{H}{A}
      \nextlevel[1,4]
      \mess{$k$}{A}{B}
      \nextlevel[1,4]
      \mess{$r\qquad\qquad\qquad$}{A}{B}
      \nextlevel[1,5]
      \action*{check $\hash(d_B,k,r) \stackrel{?}{=} m_0$}{B}
      \nextlevel[1,4]
      \nextlevel[1,4]
      \mess{$m_B = r$}{B}{H}
      \mess{$m_A = r$}{A}{H}
      \nextlevel[1,5]
      \action*{check $m_A=m_B$}{H}
      \nextlevel[1,5]
      \nextlevel[3]
      \mess{accept/reject}{H}{A}
      \mess{accept/reject}{H}{B}

    \end{msc}
}
    
    \caption{Manual authentication mechanism 6}
\end{figure}

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
\multicolumn{2}{|c|}{scenario} & \# traces & time & status \\ \hline
\multirow{2}{*}{one session} & Auth. A & 2712 & $<$ 30s & ok \\ 
& Auth. B & 3240 & 33s& ok \\  \hline
\multirow{2}{*}{without start} & Auth. A & ? & $<$ ? & ? \\ 
& Auth. B & ? & $<$ ? & ? \\  \hline
without start & Auth. A & ? & $<$ ? & ? \\ 
+ h strong & Auth. B & ? & $<$ ? & ? \\  \hline
%\multirow{2}{*}{two sessions B in par.} & Auth. A & & & attack  \\ 
%& Auth. B & & & attack  \\  \hline
\multirow{2}{*}{two sessions} & Auth. A & ? & ? & ? \\ 
& Auth. B & ? & ? & ? \\  \hline
\end{tabular}
\end{center}



\end{document}
