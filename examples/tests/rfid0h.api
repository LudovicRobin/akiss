symbols plus/2, zero/0, h/1;

private idA, idB;
channels C;
var X, Y, Z;

rewrite plus(zero,X) -> X;
rewrite plus(X,X) -> zero;

// An imaginary bad protocol where there is a traceability attack:
// choose X=Y, observe the difference of identifiers after a xor

same = in(C,X).out(C,plus(h(X),idA)).in(C,Y).out(C,plus(h(Y),idA));
diff = in(C,X).out(C,plus(h(X),idA)).in(C,Y).out(C,plus(h(Y),idB));

equivalentct? same and diff;
